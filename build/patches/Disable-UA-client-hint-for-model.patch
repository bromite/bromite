From: csagan5 <32685696+csagan5@users.noreply.github.com>
Date: Thu, 22 Jul 2021 23:10:52 +0200
Subject: Disable UA client hint for model

Disable permissions policy by default
---
 content/public/common/content_features.cc             | 2 +-
 third_party/blink/common/client_hints/client_hints.cc | 4 +++-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/content/public/common/content_features.cc b/content/public/common/content_features.cc
--- a/content/public/common/content_features.cc
+++ b/content/public/common/content_features.cc
@@ -296,7 +296,7 @@ const base::Feature kExtraSafelistedRequestHeadersForOutOfBlinkCors{
 
 // Controls whether Client Hints are guarded by Permissions Policy.
 const base::Feature kFeaturePolicyForClientHints{
-    "FeaturePolicyForClientHints", base::FEATURE_ENABLED_BY_DEFAULT};
+    "FeaturePolicyForClientHints", base::FEATURE_DISABLED_BY_DEFAULT};
 
 // Enables the AccessHandle surface for File System Access API's Origin Private
 // File System. Tracking bug: https://crbug.com/1218431.
diff --git a/third_party/blink/common/client_hints/client_hints.cc b/third_party/blink/common/client_hints/client_hints.cc
--- a/third_party/blink/common/client_hints/client_hints.cc
+++ b/third_party/blink/common/client_hints/client_hints.cc
@@ -106,6 +106,9 @@ absl::optional<std::vector<network::mojom::WebClientHintsType>> FilterAcceptCH(
   for (network::mojom::WebClientHintsType hint : in.value()) {
     // Some hints are supported only conditionally.
     switch (hint) {
+      case network::mojom::WebClientHintsType::kUAModel:
+        // model is never provided for privacy reasons
+        break;
       case network::mojom::WebClientHintsType::kLang:
         if (permit_lang_hints)
           result.push_back(hint);
@@ -114,7 +117,6 @@ absl::optional<std::vector<network::mojom::WebClientHintsType>> FilterAcceptCH(
       case network::mojom::WebClientHintsType::kUAArch:
       case network::mojom::WebClientHintsType::kUAPlatform:
       case network::mojom::WebClientHintsType::kUAPlatformVersion:
-      case network::mojom::WebClientHintsType::kUAModel:
       case network::mojom::WebClientHintsType::kUAMobile:
       case network::mojom::WebClientHintsType::kUAFullVersion:
       case network::mojom::WebClientHintsType::kUABitness:
-- 
2.17.1

